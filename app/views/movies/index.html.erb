<h3>Welcome to Movie Booking </h3>
<hr/>
<div class="row">
  <% @movies.each do |movie| %>
    <div class="col-sm-6">
      <div class="card">
        <div class=" card-block">
          <h4 class="card-title"><%= movie.name %></h4>

            <% movie.screens.uniq.each do | screen| %>
              <p class="card-text">
                <%= screen.name %> Seats: <%=screen.seats%>
                <table class='table'>
                  <thead>
                    <tr>
                      <th>Date</th>
                      <th>Start Time</th>
                      <th>End Time</th>
                      <th>Seat Price</th>
                      <% if current_user %>
                        <th>Action</th>
		      <% end %>
                    </tr>
                   </thead>
                   <tbody>
                     <% screen.shows.where(movie_id: movie.id).includes(:time_slot).each do |show| %>
                       <tr>
                         <td><%= show.show_date %></td>
			 <td><%= show.time_slot.start_time.strftime("%H:%M") %></td>
                         <td><%= show.time_slot.end_time.strftime("%H:%M") %></td>
			 <td><%= show.seat_price %></td>
                         <% if current_user && show.valid_showtime? %>
                         <td>
                           <%= link_to new_booking_path(show_id: show.id) do %>
        	             <button class="btn btn-primary">Book</button>
                           <% end %>
                         </td>
                         <% end %>
                       </tr>
                     <% end %>
                   </tbody>
                 </table>
               </p>
             <% end %>
            </div>
          </div>
        </div>
     <% end %>
  </div>
</div>
